# 一、TCP/IP协议
## 1. 概述
1. **OSI七层**参考模型，从上到下：**应用层、表示层、会话层、传输层、网络层、数据链路层、物理层**。
2. **四层协议：应用层、传输控制层、网络层、数据链路层。**
3. **传输控制层、网络层、数据链路层都属于`kernel`内核层的协议**
## 2. 传输控制层
4. `三次握手`,不可以改为两次握手，通信传输是双向的，都有输入、输出，客户端、服务端都要有输入、输出，且确认状态，这样才能保证客户端/服务端的输入、输出能准确到达对方。
5. **当双方建立连接后，双方的操作系统(内核kernel)才会开辟资源**，资源是为对方服务的，连接是虚无的。
6. 端口号，socket套接字: ip + port 、ip + port，每一个socket是独立的，是隔离的。
6. `四次分手`：释放资源

```bash
# 网络通信统计
netstat -natp
```
## 3. 网络层
1. 网络层的目的就是找下一跳
7. ip：前三位是网络号，局域网的网络号，最后一位是主机号
8. netmask(子网掩码)：通过子网掩码可以推出ip地址
9. gateway(网关)：局域网出口的关口
## 4. 链路层
1. 路由器、交换机、mac地址、`arp协议`
2. 路由器：不同局域网(网络)之间互相访问的设备，有路由表，route -p
3. 交换机: 局域网内部数据包转发的一个设备，没有路由表。同一个局域网之间不同ip之间访问的设备。
4. 在互联网通信过程，数据包交换过程中，ip是不变的，代表的是端点信息，mac地址一直被替换，即寻找下一条的节点信息。
## 5. 物理层
1. 网卡，前导码，单臂路由
2. 

# 二、VLAN 虚拟局域网
- **VLAN的概念，特性以及必要性**：
1. 传统LAN通过物理切割广播域，VLAN使用逻辑切割广播域，解耦主机的物理位置与LAN之间的联系，虽然增加了复杂度但是带来了更大的灵活性。
- **VLAN的访问连接，访问链接（Access Link）与汇聚链接（Trunk Link）**
1. 访问链接属于一种VLAN，用于链接客户机，汇聚链接可以属于多种VLAN，多用于链接路由器或交换机。
- **访问链接的设置，静态配置与动态配置**。1. 静态配置绑定VLAN与交换机端口，而动态配置解偶了交换机端口与VLAN的绑定，可以基于MAC/IP/用户来配置VLAN，其层级越高越灵活。
- **汇聚方式；ISL（Inter Switch Link，Cisco专属）与IEEE 802.1Q**
1. 前者通过增加ISL包头(ISL Header)区分VLAN；后者通过附加VLAN Tag来区分VLAN（最多4096个）。无论是ISL包头还是VLAN Tag，当数据包到达主机前都会被删除，主机对VLAN无感知。
- **VLAN间路由**：
1. 路由器根据目的IP查询路由表为数据包更换ISL头或VLAN tag使得数据包能进入其他VLAN。可以使用传统路由器与三层交换机，前者依靠软件处理VLAN间路由，随着VLAN的增加，路由器和交换机互联的汇聚链路容易成为速度瓶颈；后者在内部集成路由器，内部链接保证汇聚链路大带宽，并且可以通过路由结果缓存加速VLAN间路由。
- **VLAN的优缺点**：
1. 使用VLAN构建局域网，用户能够不受物理链路的限制而自由地分割广播域，但其代价是网络结果的复杂化。使用VLAN需要注意网络的逻辑结构与物理结构的差异。